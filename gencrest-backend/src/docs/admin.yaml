paths:
  /admin/users/upload:
    post:
      summary: Bulk upload users from an Excel file
      tags: [Admin]
      description: |
        Upload an Excel (`.xlsx` or `.xls`) file to create or update users in bulk.

        The uploaded Excel **must contain these exact column headers** (case-sensitive):

        | Column Name  | Description                          | Example Value         |
        |---------------|--------------------------------------|------------------------|
        | code          | Employee ID (unique identifier)      | GN9046                |
        | name          | Full name of the user                | Siva Krishna B        |
        | joiningDate   | Date of joining (YYYY-MM-DD)         | 2023-12-01            |
        | role          | User role                            | MDO                   |
        | email         | Email address                        | user@example.com      |
        | phone         | Phone number                         | +919876543210         |
        | reportingTo   | Employee ID of reporting manager     | GN1024                |
        | location      | Work location                        | Atmakur               |
        | territory     | Sales territory                      | Nellore               |
        | region        | Business region                      | Guntur                |
        | state         | State                                | Andhra Pradesh        |
        | zone          | Zone                                 | South Zone            |

        ⚠️ **Validation Rules:**
        - All column names are case-sensitive.
        - Upload will fail if any required column is missing or misnamed.
        - Extra columns are ignored but logged as warnings.
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - file
              properties:
                file:
                  type: string
                  format: binary
                  description: Excel file (.xlsx or .xls) containing user data.
      responses:
        "200":
          description: Upload completed successfully — returns a summary of the operation.
          content:
            application/json:
              schema:
                type: object
                properties:
                  totalRows:
                    type: integer
                  created:
                    type: integer
                  updated:
                    type: integer
                  errors:
                    type: array
                    items:
                      type: string
              examples:
                success:
                  value:
                    totalRows: 150
                    created: 120
                    updated: 25
                    errors: []
        "400":
          description: Bad Request — Missing file or invalid Excel format.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Invalid Excel format: missing columns → status, email"
        "401":
          description: Unauthorized — Missing or invalid token.
        "403":
          description: Forbidden — Admin access required.

  /admin/products/upload:
    post:
      summary: Bulk upload products from an Excel file
      tags: [Admin]
      description: |
        Upload an Excel (`.xlsx` or `.xls`) file to create or update product records.

        The Excel **must include these columns**:

        | Column Name  | Description                    | Example Value     |
        |---------------|--------------------------------|------------------|
        | name          | Product name                   | Agrosatva        |
        | sku           | SKU or variant label           | 500 ml           |
        | category      | Product category               | Biostimulant     |
        | price         | Product price (numeric)        | 810.0            |
        | productCode   | Unique product code (optional, auto-generated if missing) | FGCMGM0092 |

        ⚙️ If `productCode` is missing, it will be generated as `temp_<name>_<sku>`.
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - file
              properties:
                file:
                  type: string
                  format: binary
                  description: Excel file (.xlsx, .xls) containing product data.
      responses:
        "200":
          description: Upload completed successfully — returns operation summary.
          content:
            application/json:
              schema:
                type: object
                properties:
                  totalRows:
                    type: integer
                  created:
                    type: integer
                  updated:
                    type: integer
                  errors:
                    type: array
                    items:
                      type: string
              examples:
                success:
                  value:
                    totalRows: 100
                    created: 80
                    updated: 15
                    errors: []
        "400":
          description: Bad Request — Invalid file or missing required columns.
        "401":
          description: Unauthorized — Missing or invalid token.
        "403":
          description: Forbidden — Admin access required.

  /admin/distributors/upload:
    post:
      summary: Bulk upload distributors from an Excel file
      tags: [Admin]
      description: |
        Upload an Excel (`.xlsx` or `.xls`) file to bulk create or update distributors.

        The Excel **must include these columns**:

        | Column Name     | Description                                  | Example Value                     |
        |-----------------|----------------------------------------------|----------------------------------|
        | distributorCode | Unique distributor ID                        | 44                               |
        | dateCreated     | Date and time of creation (DD-MM-YYYY HH:mm) | 03-12-2021 11:30                 |
        | isActive        | Active status (true/false)                   | true                             |
        | name            | Distributor name                             | Vasudha Swaraj Pvt Ltd           |
        | companyName     | Company name                                 | Vasudha Swaraj Pvt Ltd           |
        | category        | Distributor category                         | Agri                             |
        | vertical        | Business vertical                            | B2C Customer                     |
        | territory       | Territory                                    | Khandwa                          |
        | city            | City                                         | Petlawad                         |
        | region          | Region                                       | Indore                           |
        | zone            | Zone                                         | Madhya Pradesh                   |
        | state           | State                                        | Madhya Pradesh                   |
        | address         | Full address (multi-line supported)          | Vasudha Swaraj Pvt Ltd, Near TVS |
        | pincode         | 6-digit postal code                          | 457773                           |

        ⚠️ **Validation Rules:**
        - Missing or misnamed columns will cause upload failure.
        - Multi-line addresses (`\n`) will be automatically converted to commas.
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - file
              properties:
                file:
                  type: string
                  format: binary
                  description: Excel file (.xlsx, .xls) containing distributor data.
      responses:
        "200":
          description: Upload completed successfully — returns operation summary.
          content:
            application/json:
              schema:
                type: object
                properties:
                  totalRows:
                    type: integer
                  created:
                    type: integer
                  updated:
                    type: integer
                  errors:
                    type: array
                    items:
                      type: string
              examples:
                success:
                  value:
                    totalRows: 50
                    created: 40
                    updated: 5
                    errors: []
        "400":
          description: Bad Request — Missing file or invalid Excel structure.
        "401":
          description: Unauthorized — Missing or invalid token.
        "403":
          description: Forbidden — Admin access required.

  /admin/liquidation/upload:
    post:
      summary: Bulk upload distributor liquidation, stock and sales data
      tags: [Admin]
      description: |
        Upload an Excel (`.xlsx` or `.xls`) file containing distributor stock and monthly sales/liquidation data.

        The uploaded Excel must include the following **exact column headers** (case-sensitive):

        | Column Name            | Description                                      | Example Value |
        |-------------------------|--------------------------------------------------|----------------|
        | distributorCode         | Unique distributor ID                           | 44             |
        | productCode             | Product code                                    | FGCMGM0092     |
        | updatedBy               | User who updated this record                    | admin01        |
        | openingStock            | Opening stock quantity                          | 120            |
        | sales_april             | Sales quantity for April                        | 10             |
        | sales_may               | Sales quantity for May                          | 12             |
        | sales_june              | Sales quantity for June                         | 8              |
        | sales_july              | Sales quantity for July                         | 15             |
        | sales_august            | Sales quantity for August                       | 20             |
        | sales_september         | Sales quantity for September                    | 5              |
        | liquidation_april       | Liquidation amount for April                    | 3000           |
        | liquidation_may         | Liquidation amount for May                      | 4000           |
        | liquidation_june        | Liquidation amount for June                     | 2500           |
        | liquidation_july        | Liquidation amount for July                     | 3500           |
        | liquidation_august      | Liquidation amount for August                   | 4200           |
        | liquidation_september   | Liquidation amount for September                | 5000           |
        | ytdNetSales             | Year-to-date total sales                        | 20000          |
        | closingBalance          | Closing stock balance                           | 90             |

        ⚠️**Validation Rules:**
        - All columns are case-sensitive and required.
        - If any column is missing, upload will fail with a 400 response.
        - System auto-links distributorCode and productCode to existing records.
        - Calculates aggregated stock and liquidation summaries automatically.
      security:
      - bearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - file
              properties:
                file:
                  type: string
                  format: binary
                  description: Excel file (.xlsx or .xls) containing distributor stock and sales data.
      responses:
      "200":
        description: Upload completed successfully — returns upload summary.
        content:
          application/json:
            schema:
              type: object
              properties:
                totalRows:
                  type: integer
                  example: 150
                created:
                  type: integer
                  example: 80
                updated:
                  type: integer
                  example: 60
                errors:
                  type: array
                  items:
                    type: string
              example:
                totalRows: 150
                created: 80
                updated: 60
                errors:
                  - "Row 12: Missing productCode"
                  - "Row 27: Invalid numeric value in sales_july"
      "400":
        description: Bad Request — Missing or invalid Excel format.
        content:
          application/json:
            schema:
              type: object
              properties:
                error:
                  type: string
                  example: "Invalid Excel format: missing columns → distributorCode, productCode"
      "401":
        description: Unauthorized — Missing or invalid bearer token.
      "403":
        description: Forbidden — Only administrators can perform this operation.
      "500":
        description: Internal Server Error — Unexpected error during processing.
